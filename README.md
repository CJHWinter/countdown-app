# 倒计时氛围感 ⏰

一个精美的双模式计时网页应用，提供专注倒计时和实时时钟功能，内置500+条励志名言，具有出色的视觉效果和音效反馈。

## ✨ 核心功能

### 🎯 专注模式
- **精确倒计时**: 支持天/时/分/秒显示，误差控制在毫秒级别
- **分组快捷设置**: 常用时长、快速专注、深度专注三大分组，涵盖10分钟到8小时
- **增强时间选择**: 美化的日期时间选择器，支持实时预览和剩余时间计算
- **进度可视化**: 动态进度条和百分比显示
- **氛围音效**: 心跳音效营造紧张感，完成时播放成功音效
- **完成庆祝**: 光爆动画、震动反馈（支持设备）
- **智能继续**: 完成后可快速继续15分钟专注，自动停止音乐进入专注状态
- **奖励音乐系统**: 完成后播放选定的奖励音乐，支持搜索和筛选

### 🕐 日常时钟模式
- **北京时间显示**: 自动从多个时间API获取标准时间
- **智能校准**: 每5-10分钟自动校准，误差≤1秒
- **离线降级**: API失败时自动切换到本地时间
- **数字翻牌效果**: 每个数字独立的翻转动画
- **秒数控制**: 可选择显示/隐藏秒数
- **实时同步状态**: 显示最后同步时间和状态

### 📜 名言系统
- **海量名言**: 内置500+条中文励志名言
- **智能分类**: 按"时间"、"专注"、"努力"、"成功"等标签过滤
- **多种切换方式**: 手动切换、自动轮播、随机显示
- **打字机效果**: 优雅的文字显示动画
- **收藏功能**: 本地持久化收藏，支持导出
- **复制分享**: 一键复制名言到剪贴板

### 🎨 视觉设计
- **暗色主题**: 护眼的深色界面，支持浅色模式切换
- **霓虹渐变**: 科技感十足的渐变色彩
- **动态背景**: 微粒效果背景增强氛围感
- **响应式设计**: 移动端优先，PC端完美适配
- **流畅动画**: 60fps流畅动画，支持减少动画选项

### 🎵 音乐系统
- **双模式音乐**: 专注完成奖励音乐和休息背景音乐分离管理
- **智能缓存**: 音乐列表自动保存到本地存储，避免重复扫描
- **智能搜索**: 实时搜索音乐文件，快速定位所需曲目
- **拓展音乐库**: 加宽音乐列表显示，支持更多音乐展示
- **左侧控制面板**: 独立的音乐控制图标，可随时收起/展开播放器
- **模式智能切换**: 不同模式间自动适配音乐控制显示
- **文件夹指引**: 明确的音乐文件夹路径提示，便于用户管理音乐
- **缓存管理**: 提供清除音乐缓存功能，支持重新扫描音乐文件

### 🔊 音效系统
- **多种音效**: 滴答声、心跳声、完成提示音
- **音量控制**: 独立音量调节和静音开关
- **场景化音效**: 不同情况播放对应音效
- **可配置性**: 每种音效都可单独开关

## 🚀 快速开始

### 方法一：直接使用
1. 下载所有文件到本地目录
2. 用现代浏览器打开 `index.html`
3. 开始使用！

### 方法二：本地服务器（推荐）
```bash
# 使用 Python 3
python -m http.server 8000

# 使用 Node.js
npx serve .

# 使用 PHP
php -S localhost:8000
```

然后访问 `http://localhost:8000`

## 📁 项目结构

```
倒计时氛围感/
├── index.html          # 主页面文件
├── styles.css          # 样式文件
├── app.js             # 应用逻辑
├── quotes.json        # 名言数据 (500+条)
├── assets/            # 资源文件
│   ├── audio/         # 音频文件
│   │   ├── tick.mp3/ogg      # 滴答音效
│   │   ├── heartbeat.mp3/ogg # 心跳音效
│   │   ├── completion.mp3/ogg # 完成音效
│   │   └── README.md         # 音频文件说明
│   └── fonts/         # 字体文件 (可选)
│       └── README.md  # 字体使用说明
└── README.md          # 项目说明文档
```

## 🎮 使用指南

### 基本操作
- **模式切换**: 点击顶部"专注模式"或"日常时钟"按钮
- **主题切换**: 点击右上角月亮/太阳图标
- **设置面板**: 点击齿轮图标打开设置

### 专注模式操作
1. **快捷时间设置**: 三大分组快捷选项
   - ⏱️ 常用时长：25分钟、45分钟、1.5小时、2小时
   - 🚀 快速专注：10分钟、15分钟、30分钟、1小时  
   - 💪 深度专注：3小时、4小时、6小时、8小时
2. **精确时间设置**: 增强版日期时间选择器，支持实时预览剩余时间
3. **选择奖励音乐**: 在音乐列表中选择完成后播放的音乐，支持搜索筛选
4. **开始倒计时**: 点击"🚀 开始专注"按钮
5. **继续专注**: 完成后点击"继续专注15分钟"自动停止音乐并开始新的专注
6. **控制倒计时**: 使用暂停/继续、停止按钮

### 休息模式操作
1. **快捷休息设置**: 点击快捷时间按钮直接设置休息时长
2. **选择休息音乐**: 搜索并选择休息时播放的背景音乐
3. **开始休息**: 点击"🌸 开始休息"按钮
4. **音乐控制**: 使用左侧音乐控制图标管理播放器显示

### 日常时钟操作
1. **显示/隐藏秒数**: 点击"👁️ 显示秒数"按钮
2. **手动同步**: 点击"🔄 同步时间"按钮
3. **查看同步状态**: 观察底部的状态指示器

### 名言系统操作
1. **手动切换**: 使用左右箭头按钮
2. **自动播放**: 点击播放按钮开启自动轮播
3. **复制名言**: 点击复制按钮
4. **收藏名言**: 点击心形按钮
5. **标签过滤**: 点击不同标签按钮筛选名言

### 音乐搜索和控制
1. **搜索音乐**: 在音乐选择区域的搜索框中输入关键词
2. **快速清除**: 点击搜索框右侧的✕按钮清除搜索
3. **左侧控制**: 点击屏幕左侧的音乐图标🎵控制播放器显示/隐藏
4. **模式适配**: 音乐控制只在专注模式和休息模式下显示
5. **添加音乐**: 将音乐文件放入对应文件夹（music/学习/ 或 music/休息/），然后点击🔄刷新
6. **刷新音乐**: 点击🔄按钮重新扫描音乐文件夹并保存到缓存
7. **清除缓存**: 在设置中点击"清除音乐缓存"重新扫描所有音乐

### 音效控制
1. **开启音效**: 点击右下角音效按钮
2. **调节音量**: 鼠标悬停显示音量滑块
3. **设置中配置**: 在设置面板中单独控制各种音效

## ⚙️ 配置说明

### 时间校准策略
应用使用多级时间校准策略确保精确度：

1. **主要API**: `worldtimeapi.org/api/timezone/Asia/Shanghai`
2. **备用API**: `timeapi.io` 和 `time.is`
3. **降级方案**: 本地 `Intl.DateTimeFormat` with `timeZone: 'Asia/Shanghai'`
4. **校准频率**: 每5分钟自动校准一次
5. **错误处理**: API失败时自动切换到下一个或本地时间

### 数据持久化
应用使用 `localStorage` 保存以下设置：
- 主题偏好 (深色/浅色)
- 倒计时目标时间
- 是否显示秒数
- 音效开关和音量设置
- 名言轮播间隔
- 收藏的名言列表
- 各种偏好设置

### 性能优化
- **懒加载**: 名言数据按需加载
- **动画优化**: 使用 `requestAnimationFrame` 确保流畅
- **内存管理**: 合理清理定时器避免内存泄漏
- **缓存策略**: 时间校准结果缓存减少API调用
- **减少重绘**: 只在数值变化时触发数字翻转动画

## 🎯 技术特性

### 前端技术栈
- **纯前端**: HTML5 + CSS3 + 原生JavaScript
- **无依赖**: 不依赖任何第三方框架
- **现代CSS**: CSS变量、Flexbox、Grid布局
- **响应式**: 移动优先的响应式设计
- **渐进增强**: 核心功能在所有现代浏览器中可用

### 浏览器兼容性
- **Chrome/Edge**: 88+ (完全支持)
- **Firefox**: 85+ (完全支持)  
- **Safari**: 14+ (完全支持)
- **移动浏览器**: iOS Safari 14+, Chrome Mobile 88+

### 可访问性支持
- **键盘导航**: 全功能键盘支持
- **屏幕阅读器**: 完整的ARIA标签
- **减少动画**: 支持 `prefers-reduced-motion`
- **高对比度**: 支持高对比度显示
- **语义化HTML**: 良好的HTML结构

### 离线支持
- **基础功能**: 倒计时和时钟无需网络
- **名言系统**: 内置数据支持离线使用
- **时间校准**: 网络不可用时自动降级
- **设置保存**: 本地存储不依赖网络

## 🔧 自定义指南

### 添加新的名言
编辑 `quotes.json` 文件，按以下格式添加：
```json
{
  "text": "你的名言内容",
  "author": "作者姓名", 
  "tags": ["标签1", "标签2"]
}
```

### 修改主题颜色
在 `styles.css` 中修改CSS变量：
```css
:root {
  --accent-primary: #00d4ff;    /* 主要强调色 */
  --accent-secondary: #ff6b35;  /* 次要强调色 */
  --bg-primary: #0a0a0a;        /* 主背景色 */
  /* 更多颜色变量... */
}
```

### 调整动画效果
修改动画相关CSS变量：
```css
:root {
  --animation-fast: 0.15s;      /* 快速动画 */
  --animation-normal: 0.3s;     /* 普通动画 */
  --animation-slow: 0.6s;       /* 慢速动画 */
}
```

### 自定义音效
替换 `assets/audio/` 目录中的音频文件，保持相同的文件名和格式。

## 🔧 开发说明

### 代码结构
- **CountdownApp类**: 主应用类，管理所有功能
- **模块化设计**: 功能按模块划分，便于维护
- **事件驱动**: 使用事件系统解耦组件
- **状态管理**: 集中式状态管理和持久化

### 关键算法
1. **时间计算**: 基于时间戳差值计算，避免累积误差
2. **动画调度**: 使用 `requestAnimationFrame` 确保流畅
3. **数字翻转**: CSS3 transform实现3D翻转效果
4. **随机算法**: Fisher-Yates洗牌算法随机排列名言

### 错误处理
- **网络错误**: 自动降级到备用方案
- **音频错误**: 静默失败，不影响核心功能
- **数据错误**: 验证和默认值确保稳定性
- **用户错误**: 友好的错误提示和指导

## 🎵 音效资源

### 获取音效文件
由于版权和文件大小限制，音效文件需要自行获取：

1. **推荐网站**:
   - [Freesound.org](https://freesound.org) - 免费音效库
   - [Zapsplat.com](https://zapsplat.com) - 高质量音效
   - [Adobe Audition音效库](https://www.adobe.com/products/audition.html)

2. **搜索关键词**:
   - 滴答声: "tick", "clock", "metronome"
   - 心跳声: "heartbeat", "pulse"  
   - 完成音: "success", "achievement", "bell"

3. **音频要求**:
   - 格式: MP3 + OGG (双格式确保兼容性)
   - 采样率: 44.1kHz或48kHz
   - 比特率: 128kbps以上
   - 文件大小: 建议每个文件<500KB

详见 `assets/audio/README.md` 的详细说明。

## 🌐 部署指南

### 静态网站托管
应用可部署到任何静态网站托管服务：

#### GitHub Pages
1. 上传代码到GitHub仓库
2. 在仓库设置中启用GitHub Pages
3. 选择主分支作为源
4. 访问 `https://username.github.io/repository-name`

#### Netlify
1. 将代码推送到Git仓库
2. 在Netlify连接仓库
3. 自动部署，获得自定义域名

#### Vercel
1. 导入Git仓库到Vercel
2. 自动部署和SSL证书
3. 支持自定义域名

### 服务器部署
可部署到任何支持静态文件的Web服务器：
- **Apache**: 直接放入 `htdocs` 目录
- **Nginx**: 配置静态文件服务
- **Node.js**: 使用Express托管静态文件

## 🐛 故障排除

### 常见问题

#### 1. 时间显示不准确
- **检查**: 网络连接是否正常
- **解决**: 点击"同步时间"手动同步
- **原因**: 时间API可能暂时不可用

#### 2. 音效无法播放
- **检查**: 音频文件是否存在于正确路径
- **解决**: 参考音频文件说明获取音效
- **原因**: 浏览器可能阻止了自动播放

#### 3. 名言无法加载
- **检查**: `quotes.json` 文件是否存在
- **解决**: 确保文件路径正确且格式有效
- **原因**: 文件路径或JSON格式问题

#### 4. 动画卡顿
- **检查**: 浏览器性能和其他标签页占用
- **解决**: 在设置中启用"减少动画"
- **原因**: 设备性能或浏览器资源不足

#### 5. 移动端显示异常
- **检查**: 浏览器是否为现代浏览器
- **解决**: 更新浏览器到最新版本
- **原因**: CSS Grid/Flexbox兼容性问题

### 调试技巧
1. 打开浏览器开发者工具查看错误信息
2. 检查网络标签页确认API请求状态
3. 查看控制台日志了解应用状态
4. 清除localStorage重置设置: `localStorage.clear()`

## 📞 支持与反馈

### 问题报告
如遇到问题，请提供以下信息：
- 浏览器版本和操作系统
- 具体的错误症状和重现步骤
- 浏览器控制台的错误信息
- 网络环境情况

### 功能建议
欢迎提出改进建议：
- 新的音效种类
- 更多的名言分类
- 界面优化建议
- 新功能需求

## 📄 开源协议

本项目采用 MIT 协议开源，允许自由使用、修改和分发。

### 第三方资源致谢
- **字体**: Google Fonts (Orbitron, Noto Sans SC)
- **时间API**: WorldTimeAPI, TimeAPI
- **设计灵感**: 现代化数字仪表盘
- **音效来源**: 需要用户自行获取，建议使用CC协议的免费资源

## 🔄 更新日志

### v1.1.4 (当前版本)
- 🔧 **修复时间预览Bug**: 修复日期时间预览显示"剩余0分钟"的问题，实现准确的实时计算
- ⚡ **实时动态更新**: 时间预览每秒自动更新，动态显示剩余时间变化
- 🎨 **智能颜色提示**: 剩余时间根据紧迫程度显示不同颜色（绿色>橙色>红色）
- 🔄 **性能优化**: 智能控制预览更新，仅在专注模式下运行，页面隐藏时自动停止
- 🐛 **错误处理增强**: 改进时间格式解析和错误提示，提升稳定性

### v1.1.3 
- 🎵 **移除添加音乐按钮**: 由于Web技术限制移除不完善的添加功能，改为明确的文件夹指引
- ⏰ **分组快捷设置**: 新增三大分组（常用时长、快速专注、深度专注），覆盖10分钟到8小时
- ⏰ **增强时间选择器**: 美化界面并新增实时预览功能，显示目标时间和剩余时长
- 🎨 **快捷按钮色彩分类**: 不同类型的快捷按钮使用不同颜色，提升识别度
- 📱 **移动端优化**: 改进移动设备上的快捷设置和时间选择器布局

### v1.1.2 
- 🎵 **音乐列表智能缓存**: 音乐列表自动保存到本地存储，避免每次启动都重新扫描
- 🎵 **音乐文件夹指引**: 改进添加音乐体验，提供明确的文件夹路径指引 (music/学习/, music/休息/)
- 🎵 **刷新功能优化**: 音乐刷新后结果自动保存到缓存，下次启动直接加载
- ⚙️ **缓存管理功能**: 在设置中新增"清除音乐缓存"选项，支持重新扫描音乐文件
- 🕐 **数据过期机制**: 音乐缓存7天自动过期，确保数据时效性

### v1.1.1
- 🔧 **修复时间设置逻辑**: 快捷时间设置现在始终基于当前时间，解决日期倒退问题
- 🔧 **优化继续专注功能**: 点击"继续专注15分钟"时自动停止音乐并隐藏播放器
- 🔧 **统一时间设置逻辑**: 专注和休息模式都采用基于当前时间的直接设置方式

### v1.1.0
- ✅ **智能时间增量**: 快捷时间设置改为基于当前时间累加，更加灵活实用
- ✅ **音乐搜索功能**: 为专注和休息模式添加实时音乐搜索，快速定位所需曲目  
- ✅ **拓宽音乐列表**: 增加音乐列表显示宽度和高度，支持更多音乐展示
- ✅ **左侧音乐控制**: 新增左侧音乐控制图标，可随时收起/展开音乐播放器
- ✅ **模式智能适配**: 音乐控制在不同模式间自动显示/隐藏，增强用户体验
- ✅ **移动端优化**: 完善移动设备上的音乐控制和搜索功能体验

### v1.0.0 
- ✅ 双模式倒计时和时钟功能
- ✅ 500+条励志名言系统
- ✅ 北京时间自动校准
- ✅ 完整的音效系统
- ✅ 响应式设计和深浅主题
- ✅ 完善的设置和持久化
- ✅ 键盘快捷键支持
- ✅ 可访问性优化

### 计划功能 (v1.2.0)
- 🔄 番茄工作法模式
- 🔄 统计和历史记录
- 🔄 更多主题和自定义选项
- 🔄 云端同步功能
- 🔄 社交分享功能

---

**感谢使用倒计时氛围感！如果觉得有用，请给项目一个⭐️**
